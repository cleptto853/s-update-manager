# Configuration File

The `s-update-manager` tool uses a configuration file to manage various settings and parameters. This document explains how to set up and use the configuration file effectively.

## Configuration File Location

By default, `s-update-manager` looks for a configuration file named `.sum.config.json` in the root directory of your project. You can also specify a custom location using the `--config` CLI parameter.

## File Format

The configuration file should be in JSON format. Here's an example of a basic configuration file:

```json
{
  "templateCatalogName": "templateCatalog",
  "sumCatalog": "./mock/mockProjectToBuild/.sum/",
  "sUpdaterVersion": "../../dist/s-update-manager-1.0.0-dev.27.tgz",
  "availableSUMSuffix": ["-default.md", "-custom.md", "-extend.md"],
  "availableSUMKeySuffix": ["defaultFile", "customFile", "extendFile"],
  "sumFileMapConfigFileName": "repositoryMap.json",
  "sumFileMapConfig": "./mock/mockProjectToBuild/.sum/repositoryMap.json",
  "projectCatalog": "./mock/mockProjectToBuild/",
  "temporaryFolder": "./mock/mockProjectToBuild/.sum/temporary/",
  "sumConfigFileName": ".sum.config.json",
  "sumConfigFilePath": "./mock/mockProjectToBuild/.sum.config.json",
  "remoteRootRepositoryUrl": "https://raw.githubusercontent.com/SebastianWesolowski/s-update-manager/dev/mock/mockTemplateToUpdate",
  "remoteRepository": "https://github.com/SebastianWesolowski/s-update-manager/tree/dev/mock/mockTemplateToUpdate",
  "remoteFileMapURL": "https://raw.githubusercontent.com/SebastianWesolowski/s-update-manager/dev/mock/mockTemplateToUpdate/templateCatalog/repositoryMap.json",
  "isDebug": true,
  "_": []
}
```

- `templateCatalogName`: Name catalog in `.sum` catalog what created by `s-prepare-template` script with file to map the real files in the project
- `sumCatalog`: Path to the `.sum` catalog it main catalogh with aditional files for script
- `sUpdaterVersion`: it version what is curently used by script
- `availableSUMSuffix`: List of available SUMS suffixes, it is used to find the correct file in `.sum` catalog and build finaly file - [Adjust Configuration](adjust-configuration.md)
- `availableSUMKeySuffix`: List of available SUM key suffixes it is used to find the correct file in `.sum` catalog and build finaly file - [Adjust Configuration](adjust-configuration.md)

- `sumFileMapConfigFileName`: Name of configuration file download from remote repository, default is `repositoryMap.json`
- `sumFileMapConfig`: Path to the `repositoryMap.json` file
- `projectCatalog`: Path to the project catalog, default is `./`
- `temporaryFolder`: Path to the temporary folder, it used to store temporary files, default is `./.sum/temporary/`
- `sumConfigFileName`: Name of the sum config file, default is `.sum.config.json`
- `sumConfigFilePath`: Path to the sum config file
- `remoteRootRepositoryUrl`: URL to the remote root repository
- `remoteRepository`: URL to the remote repository
- `remoteFileMapURL`: URL to the remote file map
- `isDebug`: If true, the script will run in debug mode

## Hierarchy of Configuration Sources

s-update-manager uses a hierarchical approach to determine the final configuration:

1. Command-line arguments (highest priority)
2. Configuration file
3. Default values (lowest priority)

This means that values specified via CLI arguments will override those in the configuration file, which in turn override the default values.

## Using the Configuration File

To use the configuration file:

1. Config file will create automatically when you run `s-init` command.
2. You can change config file properties by yourself.
3. Run `s-update-manager` commands as usual. The tool will automatically read the configuration file.

## Overriding Configuration with CLI Arguments

You can override any configuration option using CLI arguments. For example:

```bash
s-update --remoteRepository="https://github.com/User/different-repo"
```

This command will use the specified remote repository, overriding any value set in the configuration file.

## repositoryMap.json

This file is used to map the real files in the project to the files in the template catalog. it depends on the remote reposoroty. if you are in your project context it will be created by `s-init`, script depends on remote repository. [repositoryMap.json what generated by `s-prepare-template`](prepare-template.md)

## repositoryMap.json different from templateCatalog

base config from remote repository:

```json
{
  "projectCatalog": "./templates/node",
  "templateCatalogName": "templateCatalog",
  "templateCatalogPath": "./templates/node/templateCatalog",
  "repositoryMapFileName": "repositoryMap.json",
  "repositoryMapFilePath": "./templateCatalog/repositoryMap.json",
  "bumpVersion": true,
  "isDebug": false,
  "_": [],
  "templateVersion": "1.0.3",
  "fileMap": [
    "templateCatalog/.gitignore-default.md",
    "templateCatalog/LICENSE-default.md",
    "templateCatalog/README.md-default.md",
    "templateCatalog/changelog.config.js-default.md",
    "templateCatalog/clean-package.config.json-default.md",
    ...
    "templateCatalog/tools/customize.sh-default.md",
    "templateCatalog/tools/upload.sh-default.md",
    "templateCatalog/tsconfig.build.json-default.md",
    "templateCatalog/tsconfig.json-default.md",
    "templateCatalog/yarn.lock-default.md"
  ],
  "templateFileList": [
    "./.gitignore",
    "./LICENSE",
    "./README.md",
    "./changelog.config.js",
    "./clean-package.config.json",
    ...
    "./tools/customize.sh",
    "./tools/upload.sh",
    "./tsconfig.build.json",
    "./tsconfig.json",
    "./yarn.lock"
  ],
  "rootPathFileList": [
    "./templates/node/.gitignore",
    "./templates/node/LICENSE",
    "./templates/node/README.md",
    "./templates/node/changelog.config.js",
    "./templates/node/clean-package.config.json",
    ...
    "./templates/node/tools/customize.sh",
    "./templates/node/tools/upload.sh",
    "./templates/node/tsconfig.build.json",
    "./templates/node/tsconfig.json",
    "./templates/node/yarn.lock"
  ]
}

```

- `projectCatalog`: Path to the project catalog
- `templateCatalogName`: Name of the template catalog
- `templateCatalogPath`: Path to the template catalog
- `repositoryMapFileName`: Name of the repository map file
- `repositoryMapFilePath`: Path to the repository map file
- `bumpVersion`: If true, the template version will be bumped
- `isDebug`: If true, the script will run in debug mode
- `_`: it reserved for cli arguments
- `templateVersion`: Version of the template
- `fileMap`: List of files to be copied from the project catalog to the `templateCatalog`
- `templateFileList`: List of files from real project
- `rootPathFileList`: List of files relatet root catalog repository

An additional key `sumFileMap` is generated in the project context. Within this object, a list of files is generated based on the remote repository and reflects the files that have been regenerated in the project.

The `sumFileMap` key is an object with files from the real project as keys and values as objects containing information about each file. Every file can have multiple suffixes such as `defaultFile`, `customFile`, `extendFile`, and `_` (empty suffix), which symbolize data about the real file.

```json
{
"sumFileMap": {
  ".gitignore": {
    "_": {
      "SUMKeySuffix": "_",
      "isCreated": true,
      "path": "./mock/mockProjectToBuild/.gitignore",
      "realFilePath": ".gitignore",
      "realPath": "./mock/mockProjectToBuild/.gitignore",
      "templateVersion": "1.0.0"
    },
    "defaultFile": {
      "SUMKeySuffix": "defaultFile",
      "isCreated": true,
      "path": "./mock/mockProjectToBuild/.sum/templateCatalog/.gitignore-default.md",
      "realFilePath": ".gitignore",
      "realPath": "./mock/mockProjectToBuild/.gitignore",
      "templateVersion": "1.0.0",
      "SUMSuffixFileName": "templateCatalog/.gitignore-default.md"
    }
  },
  ...
  }
```

- `SUMKeySuffix`: Suffix of the SUM file `_`, `defaultFile`, `customFile`, `extendFile`
- `isCreated`: If true, the file exists
- `path`: Path to the file, it is path to file in `.sum` catalog or real file path
- `realFilePath`: Path to the file in the real project it is relative to project catalog
- `realPath`: Path to the file in the real project it is absolute path to file
- `templateVersion`: Version of the template
- `SUMSuffixFileName`: local path to file in `.sum` catalog with suffix

## manualCreatedFileMap

List of files that were manually created by user and added to `.sum` catalog, it createt automatically by `s-update-manager` durring run script.

```json
{
"sumFileMap": {
  ".gitignore": {
     "_": {
      ...
    },
    "defaultFile": {
      ...
    }
  }
 },
"manualCreatedFileMap": [
  "./mock/mockProjectToBuild/.sum/templateCatalog/README.md-custom.md",
  "./mock/mockProjectToBuild/.sum/templateCatalog/tsconfig.json-custom.md",
  "./mock/mockProjectToBuild/.sum/templateCatalog/yarn.lock-custom.md"
  ]
},
```
